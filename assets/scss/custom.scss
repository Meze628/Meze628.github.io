/* 核弹级修复：强制修正左下角图标显示 */
/* 使用通用匹配，不再依赖 html 标签，同时匹配 class 和 DOM 顺序 */

/* 1. 默认/白天模式 (Light Mode) */
/* 逻辑：当 data-scheme 不是 dark 时 */
:root:not([data-scheme="dark"]) #dark-mode-toggle {
    /* 强制显示第1个图标 (toggle-left/太阳) */
    svg:nth-of-type(1), .icon-tabler-toggle-left {
        display: inline-block !important;
    }
    /* 强制隐藏第2个图标 (toggle-right/月亮) */
    svg:nth-of-type(2), .icon-tabler-toggle-right {
        display: none !important;
    }
}

/* 2. 黑夜模式 (Dark Mode) */
/* 逻辑：当 data-scheme 是 dark 时 */
:root[data-scheme="dark"] #dark-mode-toggle {
    /* 强制隐藏第1个图标 (toggle-left/太阳) */
    svg:nth-of-type(1), .icon-tabler-toggle-left {
        display: none !important;
    }
    /* 强制显示第2个图标 (toggle-right/月亮) */
    svg:nth-of-type(2), .icon-tabler-toggle-right {
        display: inline-block !important;
    }
}

/* --- 1. 代码块基础样式美化 --- */
.highlight {
    /* 核心 1：强制使用主题背景色，而不是 Dracula 的背景色 */
    background-color: var(--pre-background-color) !important;
    
    padding: var(--card-padding);
    position: relative;
    border-radius: 12px;
    box-shadow: var(--shadow-l1) !important;
    
    /* 核心 2：使用 !important 强制让宽度和边距生效，抵抗主题默认的负边距 */
    width: 96% !important; 
    margin: 20px auto !important; 
    
    box-sizing: border-box; 
}

/* --- 核心魔法：去除 Dracula 自带的深紫色背景 --- */
/* 这会让代码文字保留 Dracula 配色，但背景变成透明，透出下面的 macOS 盒子颜色 */
.highlight pre, 
.highlight table, 
.highlight td, 
.highlight tr, 
.highlight code {
    background-color: transparent !important;
}

/* --- 2. macOS 风格红绿灯头部 --- */
.article-content .highlight:before {
    content: '';
    display: block;
    background: url(/code-header.svg);
    background-repeat: no-repeat;
    background-size: 46px; 
    background-position: 12px 10px; 
    height: 32px; 
    width: 100%;
    /* 给头部加个淡淡的分隔线，更有层次感 */
    border-bottom: 1px solid var(--body-background); 
    margin-bottom: 10px;
}

/* --- 3. 细节调整 --- */
.article-content .highlight pre {
    margin: 0;
    padding: 0;
    /* 修复字体可能过大的问题 */
    font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
}

/* 针对行号表格的微调 */
.chroma .lntable { 
    border-spacing: 0;
}
.chroma .lntd:first-child {
    padding-right: 15px; 
    user-select: none;
    /* 让行号颜色稍微淡一点，不要抢了代码的风头 */
    opacity: 0.7; 
}